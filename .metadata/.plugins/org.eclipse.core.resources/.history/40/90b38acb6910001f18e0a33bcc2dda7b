/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2024 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */

#include <stdint.h>
#include <stm32f401cc.h>
#if !defined(__SOFT_FP__) && defined(__ARM_FP)
  #warning "FPU is not initialized, but the project is compiling for an FPU. Please initialize the FPU before use."
#endif

void UART_init()
{
	/* Enable the USART1 clock */
	RCC->APB2ENR | = (1<<1);

}
void uart_configuring()
{
	//Enabling the USART
	USART->CR1 |= (1<<13);

	//Setting the stop bit to one
	USART->CR2 &= ~(3<<12);

	//Setting the Baud Rate to 9600
	USART->BRR |= 4; // fraction value = 4
	USART->BRR |= 103<<4; // mantissa value = 103

	//USART Transmitter Enable
	USART->CR1 |= (1<<3);
	//USART Receiver Enable
	USART->CR1 |= (1<<2);

	while(!(USART->SR & (1<<7)))''
}
void data_tx(unsigned char data)
{

	//Data register
	USART->DR =data;   // character a

	//cheak sattus
	while(!(USART->SR & (1<<6)));
	USART->SR &= ~(1<<6); //clear TC bit

}
void Configure_GPIO()
{
	/* Set the portA 9 and 10 to Alternate Function Mode */
	GPIOA->MODER |= (2<<18) | (2<<20);


	//Configuring the PA8 & PA9 to AF7
	GPIOA->AFRH  &= ~(0xF<<4);
	GPIOA->AFRH  &= ~(0xF<<8);
	GPIOA->AFRH  |= (7<<4) | (7<<8);

}
int main(void)
{
    /* Enable the GPIOA Port */
	RCC->AHB1ENR |= (1<<0);




	for(;;);
}
/* with Reference
 * https://github.com/manticore-siva/arm_programs/blob/main/STM32F401RE/arm_uart/main.c
 * https://kunalsalvi63.medium.com/bare-metal-uart-driver-for-stm32f411cex-a8b9e773e6cb
 * https://github.com/kowalski100/STM32F4-BareMetal-Examples/blob/master/UART-Interrupt/Source/main.c
 * */
